# Логика Анализа Gemini 1.5 Pro

В этом файле описано, какие данные мы отправляем в Gemini, что именно он анализирует, и какой формат ответа мы получаем.

## 1. Отправляемые данные (Input)

Мы передаем в модель следующую информацию о рынке для анализа:

1.  **Символ (Тикер):** Например, `ETH/USDT`.
2.  **Сводка по рынку (Market Summary):**
    *   **Текущая цена (Current Price):** Цена закрытия последней свечи.
    *   **RSI (14):** Значение индекса относительной силы за 14 периодов.
    *   **Volume 20SMA:** Скользящее среднее объема за 20 периодов.
    *   **Текущий объем (Current Volume):** Объем последней свечи.
3.  **Исторические данные (Recent Candles):**
    *   CSV-строка с данными **OHLCV** (Open, High, Low, Close, Volume) за последние **40 свечей** на 1-часовом таймфрейме.
4.  **Точки разворота (ZigZag Pivots):**
    *   Список последних 5 локальных экстремумов (максимумов и минимумов), определенных алгоритмом ZigZag.

## 2. Логика Анализа (Analysis Logic)

Модель действует как эксперт по крипто-трейдингу и использует следующие методики:

1.  **Волновая теория Эллиота (Elliott Wave Theory):**
    *   Определяет текущую фазу рынка: Импульс (волны 1, 3, 5) или Коррекция (волны A, B, C).
    *   Приоритет отдается сделкам в направлении Волны 3 или 5.
2.  **Анализ Вайкоффа (Wyckoff Analysis):**
    *   Ищет паттерны Spring (пружина) или Upthrust (вынос) вблизи уровней поддержки и сопротивления.
3.  **Индикаторы (Indicators):**
    *   Использует дивергенцию RSI как подтверждающий сигнал.
4.  **Управление рисками:**
    *   Проверяет соотношение Риск/Прибыль (Risk:Reward), которое должно быть не менее 1:2.
    *   Устанавливает логичный Stop Loss (например, за локальным минимумом для Long).

## 3. Возвращаемые данные (Output)

Gemini возвращает ответ строго в формате JSON со следующей структурой:

```json
{
    "signal": "LONG" | "SHORT" | "NEUTRAL",  // Торговый сигнал
    "confidence": 8,                         // Уверенность (1-10)
    "setup_name": "Wave 3 Breakout",         // Название сетапа
    "entry_range": [1850.5, 1860.0],         // Диапазон входа
    "stop_loss": 1820.0,                     // Цена Stop Loss
    "take_profit_1": 1900.0,                 // Первая цель
    "take_profit_2": 1950.0,                 // Вторая цель
    "reasoning": "Цена пробила сопротивление на объеме, RSI > 50..." // Обоснование (макс. 2 предложения)
}
```

**Важные примечания:**
*   Если уровень уверенности (`confidence`) < 7, сигнал автоматически считается **NEUTRAL**.
*   Модель настроена на низкую "температуру" (0.2), чтобы ответы были более четкими и предсказуемыми.
